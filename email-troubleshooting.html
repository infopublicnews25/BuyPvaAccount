<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Email Troubleshooting Guide - BuyPvaAccount</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .section { background: #f5f5f5; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .step { background: white; padding: 15px; margin: 10px 0; border-left: 4px solid #007bff; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 4px; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 4px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 4px; }
        code { background: #f8f9fa; padding: 2px 6px; border-radius: 3px; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <h1>üîß Email Troubleshooting Guide</h1>
    <p>If you're not receiving ticket confirmation emails, follow these steps to diagnose and fix the issue.</p>

    <div class="section">
        <h2>Step 1: Test Email Configuration</h2>
        <p>Open: <a href="http://localhost:8000/debug-email.html" target="_blank">http://localhost:8000/debug-email.html</a></p>
        <p>This page will test if your email configuration is working.</p>
    </div>

    <div class="section">
        <h2>Step 2: Check Gmail App Password</h2>
        <div class="step">
            <h3>Why this might be the issue:</h3>
            <ul>
                <li>Gmail App Passwords can expire</li>
                <li>Google might block suspicious login attempts</li>
                <li>2-Factor Authentication might be interfering</li>
            </ul>
        </div>

        <div class="step">
            <h3>How to regenerate App Password:</h3>
            <ol>
                <li>Go to <a href="https://myaccount.google.com/security" target="_blank">Google Account Security</a></li>
                <li>Enable 2-Step Verification if not already enabled</li>
                <li>Go to <a href="https://myaccount.google.com/apppasswords" target="_blank">App Passwords</a></li>
                <li>Select "Mail" and "Other (custom name)"</li>
                <li>Enter "BuyPvaAccount" as the name</li>
                <li>Copy the 16-character password (no spaces)</li>
                <li>Update the <code>.env</code> file in the backend folder:</li>
            </ol>
            <pre>EMAIL_PASSWORD=your_new_app_password_here</pre>
        </div>
    </div>

    <div class="section">
        <h2>Step 3: Check Email Logs</h2>
        <p>When you submit a ticket, check the browser console (F12 ‚Üí Console tab) for messages like:</p>
        <div class="success">‚úÖ Ticket confirmation email sent successfully</div>
        <div class="error">‚ùå Email failed: Authentication failed</div>
        <div class="warning">‚ö†Ô∏è Could not send ticket confirmation email</div>
    </div>

    <div class="section">
        <h2>Step 4: Check Spam/Junk Folder</h2>
        <p>Even if emails are being sent successfully, they might end up in spam. Check:</p>
        <ul>
            <li>Gmail Spam folder</li>
            <li>Junk/Spam folders in other email clients</li>
            <li>Promotions tab in Gmail</li>
        </ul>
    </div>

    <div class="section">
        <h2>Step 5: Alternative Email Testing</h2>
        <p>If Gmail is not working, you can temporarily use a different email service:</p>

        <div class="step">
            <h3>Option 1: Use a different Gmail account</h3>
            <ul>
                <li>Create a new Gmail account for testing</li>
                <li>Generate an App Password for the new account</li>
                <li>Update the email-config.json and .env files</li>
            </ul>
        </div>

        <div class="step">
            <h3>Option 2: Use a transactional email service</h3>
            <p>Services like SendGrid, Mailgun, or Postmark provide better deliverability:</p>
            <ul>
                <li>Sign up for a free account</li>
                <li>Get API credentials</li>
                <li>Update the backend email configuration</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>Step 6: Verify Server Configuration</h2>
        <p>Make sure both servers are running:</p>
        <ul>
            <li><strong>Frontend:</strong> <code>python -m http.server 8000</code> (port 8000)</li>
            <li><strong>Backend:</strong> <code>node server.js</code> (port 3000)</li>
        </ul>
        <p>Test backend connectivity: <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></p>
    </div>

    <div class="section">
        <h2>Common Issues & Solutions</h2>
        <div class="warning">
            <strong>Issue:</strong> "Authentication failed"<br>
            <strong>Solution:</strong> Regenerate Gmail App Password
        </div>

        <div class="warning">
            <strong>Issue:</strong> Emails going to spam<br>
            <strong>Solution:</strong> Check spam folder, add sender to contacts
        </div>

        <div class="warning">
            <strong>Issue:</strong> "CORS error" or "Network error"<br>
            <strong>Solution:</strong> Make sure backend server is running on port 3000
        </div>

        <div class="warning">
            <strong>Issue:</strong> No error messages in console<br>
            <strong>Solution:</strong> Check browser network tab for failed requests
        </div>
    </div>

    <div class="section">
        <h2>Need Help?</h2>
        <p>If you're still having issues:</p>
        <ul>
            <li>Check the backend server console for error messages</li>
            <li>Try the debug page to isolate the problem</li>
            <li>Verify all configuration files are correct</li>
            <li>Test with different email addresses</li>
        </ul>
    </div>
</body>
</html>